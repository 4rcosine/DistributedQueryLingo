<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title></title>
    <!-- stylesheets -->
    <link rel="stylesheet" href="Treant.css" type="text/css"/>
	<!-- javascript -->
	<script src="vendor/jquery.min.js"></script>
    <script src="vendor/raphael.js"></script>
    <script src="Treant.js"></script>
</head>
<body>
	<script>
	config = {
		container: "#tree-simple",
		connectors: {
			type: "straight"
		}
	};

	nodeUNODE = {
innerHTML : "<div class='box_left'><span class='as'>U</span>, C</div><div class='box_center '><p class='op'>result to user</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: TECH<br/><i>i</i>:  <span class='enc_att'>TECH, FAIL, COST, KIND</span><br/><i>eq</i>: {ID, PROD}</div></div>"
};

nodeN10 = {
parent: nodeUNODE, innerHTML : "<div class='box_left'><span class='as'>C</span>, U, G, X, Y</div><div class='box_center '><p class='op'>projection on {TECH}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: TECH<br/><i>i</i>:  <span class='enc_att'>TECH, FAIL, COST, KIND</span><br/><i>eq</i>: {ID, PROD}</div></div><br/><div class='box_down'><span class='enc'>TECH</span></div>"
};

nodeN9 = {
parent: nodeN10, innerHTML : "<div class='box_left'><span class='as'>X</span>, U, G, C, Y</div><div class='box_center '><p class='op'>selection on {COST}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>:  <span class='enc_att'>TECH, COST</span><br/><i>i</i>:  <span class='enc_att'>TECH, FAIL, COST, KIND</span><br/><i>eq</i>: {ID, PROD}</div></div>"
};

nodeN8 = {
parent: nodeN9, innerHTML : "<div class='box_left'><span class='as'>X</span>, U, G, C, Y</div><div class='box_center '><p class='op'>sum on {COST}, grouping on {TECH}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>:  <span class='enc_att'>TECH, COST</span><br/><i>i</i>:  <span class='enc_att'>TECH, FAIL, KIND</span><br/><i>eq</i>: {ID, PROD}</div></div>"
};

nodeN7 = {
parent: nodeN8, innerHTML : "<div class='box_left'><span class='as'>X</span>, U, G, C, Y</div><div class='box_center '><p class='op'>join on {ID, PROD}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>:  <span class='enc_att'>FAIL, ID, TECH, KIND, PROD, COST</span><br/><i>i</i>:  <span class='enc_att'>FAIL, KIND</span><br/><i>eq</i>: {ID, PROD}</div></div>"
};

nodeN5 = {
parent: nodeN7, innerHTML : "<div class='box_up'><span class='enc'>ID, TECH</span></div><br/><div class='box_left'><span class='as'>T</span>, U, G, C, X, Y</div><div class='box_center '><p class='op'>selection on {KIND}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: ID, TECH <span class='enc_att'>KIND</span><br/><i>i</i>:  <span class='enc_att'>KIND</span><br/><i>eq</i>: </div></div>"
};

nodeN6 = {
parent: nodeN7, innerHTML : "<div class='box_up'><span class='enc'>COST, PROD</span></div><br/><div class='box_left'><span class='as'>G</span>, U, T, C, X, Y</div><div class='box_center '><p class='op'>selection on {FAIL}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: COST, PROD <span class='enc_att'>FAIL</span><br/><i>i</i>:  <span class='enc_att'>FAIL</span><br/><i>eq</i>: </div></div>"
};

nodeN3 = {
parent: nodeN5, innerHTML : "<div class='box_up'><span class='enc'>KIND</span></div><br/><div class='box_left'><span class='as'>T</span></div><div class='box_center '><p class='op'>projection on {ID, TECH, KIND}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: ID, TECH, KIND<br/><i>i</i>: <br/><i>eq</i>: </div></div>"
};

nodeN4 = {
parent: nodeN6, innerHTML : "<div class='box_up'><span class='enc'>FAIL</span></div><br/><div class='box_left'><span class='as'>G</span></div><div class='box_center '><p class='op'>projection on {COST, FAIL, PROD}</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: COST, FAIL, PROD<br/><i>i</i>: <br/><i>eq</i>: </div></div>"
};

nodeN1 = {
parent: nodeN3, innerHTML : "<div class='box_left'><span class='as'>T</span></div><div class='box_center  leaf'><p class='op'>ANAGRAFICA (ID, TECH, KIND, SUPERVISOR)</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: ID, TECH, KIND, SUPERVISOR<br/><i>i</i>: <br/><i>eq</i>: </div></div>"
};

nodeN2 = {
parent: nodeN4, innerHTML : "<div class='box_left'><span class='as'>G</span></div><div class='box_center  leaf'><p class='op'>TEST (FAIL, TEST, DATE, PROD, CODE, COST, VIDEO)</p></div><div class='arrow_left'></div><div class='cont_right'><div class='box_right'><i>v</i>: FAIL, TEST, DATE, PROD, CODE, COST, VIDEO<br/><i>i</i>: <br/><i>eq</i>: </div></div>"
};




	ch = [
		config, nodeUNODE, nodeN10, nodeN9, nodeN8, nodeN7, nodeN5, nodeN6, nodeN3, nodeN4, nodeN1, nodeN2
	];

	function calcRow() {
		var nodi = document.getElementsByClassName("node");
		var minLeft = parseInt(window.getComputedStyle(nodi[0]).left.replace("px", ""))
		//Trovo il left minimo
		for(var i = 0; i < nodi.length; i++) {
			var tmp = parseInt(window.getComputedStyle(nodi[i]).left.replace("px", ""));
			if (minLeft > tmp){
				minLeft = tmp;
			}
		}

		//Trovo il left massimo
		var maxLeft = parseInt(window.getComputedStyle(nodi[0]).left.replace("px", "")) + parseInt(window.getComputedStyle(nodi[0]).width.replace("px", ""));
		for(var i = 0; i < nodi.length; i++) {
			var tmp = parseInt(window.getComputedStyle(nodi[i]).left.replace("px", "")) + parseInt(window.getComputedStyle(nodi[i]).width.replace("px", ""));
			if(maxLeft < tmp) {
				maxLeft = tmp;
			}
		}


		var larghTree = maxLeft - minLeft;
		document.getElementById("kes_separator").style.width = larghTree + "px";
		document.getElementById("kes_separator").style.marginLeft = minLeft + "px";
	}

	</script>
	<div id="tree-simple" style="width:100%; min-width: 400px; height: auto"> </div>
	<div class="kes_cont" id="kes_separator"><span class="kes"><b>Key Encryption Sets</b><ul><li>{ID, PROD} - Key to be given to {G, T}</li>
<li>{KIND} - Key to be given to {T}</li>
<li>{FAIL} - Key to be given to {G}</li>
<li>{TECH} - Key to be given to {C, T}</li>
<li>{COST} - Key to be given to {G}</li>
</ul></span></div>
	<script>
		var my_chart = new Treant(ch);
		calcRow();
	</script>
</body>
</html>